<%
__this.CascadeDesign('utils/modal/abstract',
  {
    data:
    [
      'thread/plugin/amocrm.deal.create.form',
      __this,
    ],
  });

__this.DeferCascade(function()
{
  __this.first().find('.approve.button').click(function()
  {
    var form = __this.first().find('form').serializeArray();
    var values = {};
    for (var k in form)
      values[form[k].name] = form[k].value;

    phoxy.ApiRequest
    ([
      'plugin/amocrm/create',
      __this.account_id,
      __this.thread_id,
      values
    ]);
  });
});
%>
